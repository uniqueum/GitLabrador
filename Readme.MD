# ğŸ¾ GitLabrador: Cross-Platform GitLab Notifier

## ğŸ’¡ Why GitLabrador?

GitLabâ€™s `/todos` endpoint is powerful â€” but itâ€™s trapped in the browser. GitLabrador sets it free.

### ğŸš« Whatâ€™s Missing in Existing Tools
- **GitLabâ€™s own To-Do List** is web-based only â€” no native desktop notifications.  
- **Super Productivity** is a heavy-duty task manager with GitLab integration, but itâ€™s not focused on just `/todos`, and itâ€™s not a lightweight tray app.  
- **OpenTodoList** is a general-purpose task manager â€” not GitLab-specific, and lacks native GitLab push/MR awareness.
- **Email notifications** are available in GitLab, but they often get ignored or buried in inbox noise. GitLabrador delivers focused, native alerts developers actually see.

### âœ… What GitLabrador Brings
- Native OS notifications for GitLab `/todos`
- Lightweight, background-friendly architecture
- Cross-platform support (Windows, Linux, macOS)
- Dev-centric TUI for configuration, no GUI bloat
- Optional collaborator watchlist for special alerts

---

## ğŸ–±ï¸ Tray Tooltip Behavior

When GitLabrador is running as a background tray app (or menubar/panel item), hovering over the icon reveals a concise status summary:

- **Status Dot**: ğŸŸ¢ Running or ğŸ”´ Misconfigured (based on PAT and GitLab URL validity)
- **Polling Interval**: Displays the current polling frequency (e.g., `Polling every: 60s`)
- **Last Notification**: Shows the most recent GitLab event (e.g., `"MR from @alice in ProjectX"`)
- **Collaborator Watchlist**: Lists tracked usernames (e.g., `Watching: @alice, @bob`)

This tooltip provides at-a-glance insight into GitLabradorâ€™s health and activity without launching a GUI.

---

## ğŸ—ï¸ Project Structure

### 1. ğŸ“¦ Data Layer: Models (The What)

These C# classes mirror the structure of the JSON objects returned by GitLabâ€™s `/api/v4/todos`.

#### `TodoItem.cs`
```
public class TodoItem
{
    public int Id { get; set; }
    public string ActionName { get; set; } // e.g., "mentioned", "assigned"
    public string TargetType { get; set; } // e.g., "Issue", "MergeRequest"
    public DateTime CreatedAt { get; set; }
    public string WebUrl { get; set; }
    public Project Project { get; set; }
    public Author Author { get; set; }
}
```

#### `Project.cs`
```
public class Project
{
    public string NameWithNamespace { get; set; }
}
```

#### `Author.cs`
```
public class Author
{
    public string Username { get; set; }
}
```

---

### 2. ğŸŒ Service Layer: GitLab API Communication

Handles authentication and polling of GitLabâ€™s `/todos` endpoint.

#### `IGitLabService.cs`
```
public interface IGitLabService
{
    Task<List<TodoItem>> GetPendingTodosAsync();
    Task MarkTodoAsDoneAsync(int todoId);
}
```

#### `GitLabHttpClient.cs`
- Uses `HttpClient` and `System.Text.Json`
- Authenticates via Private Access Token (PAT)
- Polls `/api/v4/todos?state=pending`

---

### 3. ğŸ”” Service Layer: OS Notification Bridge

Abstracts platform-specific notification delivery.

#### `INotificationService.cs`
```
public interface INotificationService
{
    void ShowTodoNotification(TodoItem todo);
}
```

#### Platform Implementations
- `WindowsNotificationService.cs` â†’ Uses `Microsoft.Toolkit.Uwp.Notifications`
- `LinuxNotificationService.cs` â†’ Uses `notify-send` via `Process.Start`
- `MacNotificationService.cs` â†’ Uses `osascript` with AppleScript

---

### 4. â±ï¸ Application Layer: Polling Engine

#### `PollerEngine.cs`
- Timer-based polling loop
- Deduplicates by tracking notified To-Do IDs
- Triggers `INotificationService` for new items

---

### 5. ğŸ§° Configuration Layer

Stores user preferences in a local config file.

#### `config.json` Example
```
{
  "GitLabUrl": "https://gitlab.example.com",
  "PersonalAccessToken": "glpat-abc123",
  "PollingIntervalSeconds": 60,
  "Watchlist": [
    { "Username": "alice", "NotifyOn": ["Push", "MergeRequest"] }
  ]
}
```

---

### 6. ğŸ–¥ï¸ TUI Layer: Spectre.Console Settings Shell

A cross-platform terminal UI for configuring GitLabrador.

#### Features
- Prompt for GitLab URL, PAT, polling interval
- Manage collaborator watchlist
- Save config to file
- Optional CLI flags for headless setup

#### Sample Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GitLabrador Settings     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GitLab URL: [___________]  â”‚
â”‚ PAT:        [***********]  â”‚
â”‚ Polling Interval: [ 60s ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Collaborator Watchlist     â”‚
â”‚ - @alice [Push, MR]        â”‚
â”‚ [+] Add Collaborator       â”‚
â”‚ [x] Remove Collaborator    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ Save & Exit ]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Cross-Platform Strategy

| OS       | Notification Method             | Notes |
|----------|----------------------------------|-------|
| Windows  | `Microsoft.Toolkit.Uwp.Notifications` | Rich toast support |
| Linux    | `notify-send` via `Process.Start`     | Works in most DEs |
| macOS    | `osascript` with AppleScript          | Native notification |

Platform detection via `RuntimeInformation.OSDescription` ensures the correct notifier is injected at runtime.

---

## ğŸ§ª Future Enhancements

- GitHub `/notifications` support
- Persistent state via LiteDB or SQLite
- System tray integration (optional via Avalonia)
- CLI flags for scripting and automation
- Notification templates and themes

---

## ğŸ¾ GitLabrador Philosophy

- **Minimalist**: No GUI bloat, no distractions  
- **Respectful**: No spammy alerts â€” deduplicated and contextual  
- **Dev-first**: Built for developers, by developers  
- **Extensible**: Clean architecture for future integrations  

---

## ğŸ“œ License

GitLabrador will be released under the **GNU GPLv3**.

> Free puppies for all. No proprietary leashes.

---

## ğŸš€ Release Status

**Coming Soon**  
GitLabrador is currently in active development. A public release will follow once security, stability, and documentation milestones are met.
